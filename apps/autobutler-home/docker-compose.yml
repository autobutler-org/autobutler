version: '3.8'

services:
  llm:
    build:
      context: ./llm
      dockerfile: Dockerfile
    ports:
      - "8081:8081"
    volumes:
      - ./llm:/app
    deploy:
      resources:
        limits:
          memory: 4G
    restart: unless-stopped

  svc:
    build:
      context: ./svc
      dockerfile: Dockerfile
    ports:
      - "8082:8082"
    volumes:
      - ./svc:/app
    environment:
      - LLM_URL=http://llm:8081
    depends_on:
      - llm
    restart: unless-stopped

  user:
    build:
      context: ./user
      dockerfile: Dockerfile
    ports:
      - "8083:8083"
    volumes:
      - ./user:/app
    environment:
      - SVC_URL=http://svc:8082
    depends_on:
      - svc
    restart: unless-stopped 
package message

import (
    "autobutler/internal/llm"
)

templ Component(message llm.ChatMessage) {
    <div class={ chatFlexClass(message) }>
        <div class={ chatMessageClass(message) }>
            <p class="whitespace-pre-wrap">{ message.Content }</p>
            <span class="text-xs mt-2 block opacity-70">
                { message.Timestamp }
            </span>
        </div>
    </div>
}

func chatFlexClass(message llm.ChatMessage) string {
    class := "flex "
    switch message.Role {
        case llm.ChatRoleUser:
            class += "justify-end"
        default:
            class += "justify-start"
    }
    return class
}

func chatMessageClass(message llm.ChatMessage) string {
    class := "max-w-[80%] rounded-lg p-4 "
    switch message.Role {
        case llm.ChatRoleUser:
            class += "bg-blue-600 text-gray-100 dark:text-white"
        case llm.ChatRoleSystem:
            class += "bg-gray-400 dark:bg-white/10 dark:text-gray-100"
        case llm.ChatRoleDummy:
            class += "bg-orange-500/20 dark:text-gray-100 border-2 border-orange-500"
        case llm.ChatRoleError:
            class += "bg-red-500/20 dark:text-gray-100 border-2 border-red-500"
    }
    return class
}
